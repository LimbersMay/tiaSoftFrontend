<div class="bg-gray-50 p-2 flex align-items-center justify-content-between gap-2 border-b-1 border-gray-200">
  <button pButton icon="pi pi-arrow-left" class="p-button-text text-600"></button>
  <span class="text-gray-600 font-bold text-lg">Mesa {{ table?.name }}</span>
  <i class="fa-solid fa-utensils text-xl border-round-2xl text-center w-3rem h-3rem flex align-items-center justify-content-center text-600"></i>
</div>

<div class="p-3 bg-white border-round-md flex flex-column gap-2">
  <!-- Title -->
  <div class="flex justify-content-between align-items-center gap-2">
    <span class="text-primary font-bold text-lg">Informaci√≥n adicional</span>
  </div>

  <form [formGroup]="billForm">
    <!-- Client name input -->
    <input
      pInputText placeholder="Nombre del cliente" class="w-full"
      formControlName="customerName"
    />

    <p-dropdown
      [options]="bills"
      formControlName="selectedBill"
      optionLabel="name"
      dataKey="billId"
      placeholder="Seleccionar cuenta"
      [style]="{width: '100%'}"
      (onChange)="selectBill($event.value)"
      [filter]="false"
      [showClear]="true"
      [emptyFilterMessage]="'No se encontraron cuentas'"
    >
    </p-dropdown>

    <!-- Comments input -->
    <textarea
      pInputTextarea placeholder="Comentarios" class="w-full"
      formControlName="additionalInfo"
    >

    </textarea>
  </form>
</div>

<!-- Products -->
<div class="bg-gray-50 w-full flex flex-column gap-3 p-3">
  <!-- Title -->
  <div class="flex justify-content-between align-items-center gap-2">
    <span class="text-primary font-bold text-lg">Platillos</span>
  </div>

  <p-scrollPanel
    [style]="{width: '100%', height: '13rem'}"
    class="flex flex-column gap-3"
  >
      <div
        *ngFor="let product of productsToProcess"
        class="flex justify-content-between align-items-center border-1 p-3 border-gray-300 border-round-2xl mt-2">
        <div class="flex justify-content-between align-items-center gap-3">
          <img [src]="$any(product.imageUrl) | serverImageUrl" [alt]="product.name" class="w-4rem h-4rem border-round-2xl"/>
          <div class="flex flex-column gap-1">
            <span class="text-600 text-md">{{ product.name }}</span>
            <span class="text-md">{{ product.price | number: '1.0' }} $</span>
          </div>
        </div>
        <div class="flex justify-content-between align-items-center gap-3">
          <button
            (click)="decreaseQuantity(product)"
            class="p-button p-button-rounded p-button-secondary p-button-outlined w-2rem flex justify-content-center">
            <i class="pi pi-minus"></i>
          </button>
          <span class="font-bold">{{ product.quantity }}</span>
          <button
            (click)="increaseQuantity(product)"
            class="p-button p-button-rounded p-button-secondary p-button-outlined w-2rem flex justify-content-center">
            <i class="pi pi-plus"></i>
          </button>
        </div>
      </div>
  </p-scrollPanel>

</div>

<!-- Summary -->
<div class="w-full flex flex-column gap-3 p-3">
  <div class="flex flex-column gap-2 bg-gray-50 p-3 border-round-2xl">
    <!-- Title -->
    <div class="flex justify-content-between align-items-center gap-2">
      <span class="text-primary">Resumen</span>
    </div>

    <p-divider class="w-full"></p-divider>

    <!-- Subtotal -->
    <div class="flex justify-content-between align-items-center gap-2">
      <span class="text-gray-600">Subtotal</span>
      <span class="text-gray-600 font-bold">{{ currentBillTotal | number: '1.0' }} $</span>
    </div>

    <!-- Total -->
    <div class="flex justify-content-between align-items-center gap-2">
      <span class="text-gray-600">Total</span>
      <span class="text-gray-600 font-bold">{{ totalOfAllBills | number: '1.0' }} $</span>
    </div>
  </div>
</div>

<!-- Confirm button -->
<div
  class="w-full bg-transparent p-3 shadow-lg flex justify-content-center items-center gap-3"
>
  <button
    pButton
    severity="primary"
    class="p-button-lg flex w-full text-sm border-round-3xl gap-2 justify-content-center"
    (click)="onSubmit()"
  >
    <span class="font-bold text-sm">
      Ordenar
    </span>
  </button>
</div>

<p-toast position="top-right"></p-toast>
