<!-- Header -->
<div class="grid">
  <div class="col-12">
    <div class="card px-6 py-6">
      <p-toolbar styleClass="mb-4">
        <ng-template pTemplate="left">
          <div class="my-2">
            <p-button
              label="Crear area"
              icon="pi pi-plus"
              class="p-button-success"
              (click)="showDialog()"
            ></p-button>
          </div>
        </ng-template>
      </p-toolbar>

      <p-table
        [value]="areas"
        styleClass="p-datatable-striped"
        [scrollable]="true"
        [scrollHeight]="'calc(100vh - 200px)'"
        [paginator]="true"
        [rows]="10"
        [globalFilterFields]="['name', 'description']"
        responsiveLayout="stack"
      >
        <ng-template pTemplate="caption">
          <div class="flex flex-column md:flex-row md:justify-content-between md:align-items-center">
            <h5 class="m-0">Gestión de áreas</h5>
          </div>
        </ng-template>
        <ng-template pTemplate="header">
          <tr>
            <th style="min-width: 12rem">
              <div class="flex align-items-center">
                Nombre
                <p-columnFilter type="text" field="name" display="menu" placeholder="Buscar por nombre"/>
              </div>
            </th>
            <th style="min-width: 12rem">
              <div class="flex align-items-center">
                Descripción
                <p-columnFilter type="text" field="description" display="menu" placeholder="Buscar por descripción"/>
              </div>
            </th>
            <th style="min-width: 12rem">Acciones</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-area>
          <tr>
            <td>{{ area.name }}</td>
            <td>{{ area.description }}</td>
            <td>
              <button
                pButton
                pRipple
                type="button"
                icon="pi pi-pencil"
                (click)="showDialog(area)"
                class="p-button-success mr-2"
              ></button>
              <button
                pButton
                pRipple
                disabled
                type="button"
                icon="pi pi-trash"
                class="p-button-danger"
              ></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>

<!-- Dialog -->
<p-dialog [header]="currentArea.areaId ? 'Editar area' : 'Crear area'"
          [modal]="true" [(visible)]="display"
          (onHide)="closeDialog()"
          [dismissableMask]="true"
          [focusOnShow]="false"
>
  <span class="p-text-secondary block mb-5">Proporciona la siguiente información</span>
  <form action="" [formGroup]="areaForm" (ngSubmit)="onSubmit()" class="flex flex-column gap-3" autocomplete="off">

    <div class="flex align-items-center gap-3">
      <label for="name" class="font-semibold w-6rem">Nombre</label>
      <input
        formControlName="name"
        pInputText id="name"
        class="flex-auto"
        autocomplete="off"
        [ngClass]="getControlClass('name')"
      />
    </div>

    <span
      *ngIf="isValidField('name')"
      class="p-error align-self-center"
    >
      {{ getFieldError('name') }}
    </span>

    <div class="flex align-items-center gap-3">
      <label for="description" class="font-semibold w-6rem">Descripción</label>
      <input
        pInputText
        id="description"
        class="flex-auto"
        type="text"
        formControlName="description"
        [ngClass]="getControlClass('description')"
      />
    </div>

    <span
      *ngIf="isValidField('description')"
      class="p-error align-self-center"
    >
      {{ getFieldError('description') }}
    </span>

    <div class="flex justify-content-end gap-2 mt-4">
      <p-button label="Cancel" severity="secondary" (onClick)="closeDialog()"/>
      <p-button label="Save" type="submit"/>
    </div>
  </form>
</p-dialog>
